#include  <stdio.h>
#include <stdlib.h>
#include <string.h>

//定义结点 
typedef struct student
{
	int number;
	int classs; 
	char name[20]; 
    struct student *next;
	}Node ,*Linklist;
	
//采用头插法建立单链表 
Linklist toucha(int n)
{
	Linklist p,s;
	s=(Linklist)malloc(sizeof(Node));
	s->next=NULL;
    int i; 
	  
	for(i=0;i<n;i++)
	{
	    p=(Linklist)malloc(sizeof(Node));
      	printf("请输入学号，班级和姓名："); 
		scanf("%ld%d%s",&p->number,&p->classs,p->name);
		p->next=s->next;
		s->next=p;
	}
	return s;
 }

//输出链表中所有学生的信息 
void print(Linklist L)
{    printf("学生信息\n");
     Linklist p;
	 p=L->next;
	 while(p)
	 {
		 printf("学号：%ld  班级：%d  姓名：%s \n",p->number,p->classs,p->name);
		 p=p->next;
	 }  
}

  //按照姓名查找并返回该学生信息 
Linklist  xingming(Linklist L) 
{    
	Linklist p;
	char xm[20];
	p=L;
	printf("输入要查找的学生的姓名：");
	scanf("%s",xm);
	if(p->next!=NULL)
	{
	
	    p=p->next;
		if(!strcmp(p->name,xm))
	    return p;
	}
	else
	     return NULL; 
	
}
//根据指定的位置返回该学生信息

 Linklist weizhi(Linklist L,int k,int n)
  { 
  	Linklist p; 
  	 int i; 	
	 p=L->next; 
	for(i=1;i<k;i++) 
	{	p=p->next; 	} 	
	if(k<=n)
	{ 
		return p;
	 }
	 else 
	 { 
	 	return NULL; 
	 }
 }

 //将一个学生信息插入到链表指定的位置
int  add(Linklist L,int a,int n)
 {  
 	Linklist p,s;
 	int i;
 	p=L->next;
 	for(i=2;i<a;i++)
 	{
 		p=p->next;
	 }
	 s=(Linklist)malloc(sizeof(Node));//s新申请的结点 
	 printf("请输入要插入的学号:");
	 scanf("%d",&s->number);
	 printf("请输入要插入的班级：");
	 scanf("%d",&s->classs);
	 printf("请输入要插入的姓名：");
	 scanf("%s",s->name);
	 s->next=p->next;
	 p->next=s;
	 if(a<1||a>n+2){
	 	return 0;
	 }
	 else
	 {
	 	return 1;
	 }
 	}
//删除指定位置的学生信息 
int  shanchu(Linklist L,int k,int n)
{ 
	Linklist p;
	int i;
    p=L->next;
    if(p==NULL)  return 0;
	for(i=1;i<k;i++)
	{
      L=p;
	  p=p->next;		
	}
	L->next=p->next;
	free(p);
	return 1;
} 
int main(){
   
 	Linklist head ;
 	Linklist p;
 	int x,n;
    printf("学生总数：");
 	scanf("%d",&x);
	head=toucha(x);
     print(head);
    p= xingming(head);
   if(p)
   {
   printf("对应的班级是：%d 对应的学号是：%d\n",p->classs,p->number);
   }
   else
        printf("无\n");
 
   int y;
   printf("请输入要查找的学生位置信息:");
   scanf("%d",&y);
   p= weizhi(head,y,x);
   if(p){
   	printf(" 姓名：%s 班级：%d 学号：%d\n",p->name,p->classs,p->number);
   }
   else{
   	printf("输入位置错误");
   }

  int z,m;
  printf("请输入要插入信息的位置：");
   scanf("%d",&z);
   m=add(head,z,x);
    if(m){
	printf("插入成功\n");
  }
  else
  {
	printf("插入失败\n");
  }
    print(head);

  
   printf("请输入要删除学生信息的位置：");
   scanf("%d",&n);
   if(shanchu(head,n,x)) 
  {
	printf("删除成功\n");
  }
   else
  {
	printf("删除失败\n");
  }
  print(head);
  }
